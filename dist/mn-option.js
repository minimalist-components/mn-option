"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function evaluate(value){try{var isVariable=!value.startsWith("[")&&!value.startsWith("{")&&!value.startsWith("'")&&!value.startsWith('"')&&!value.startsWith("`")&&"true"!==value&&"false"!==value&&isNaN(value);return isVariable?eval("'"+value+"'"):eval("("+value+")")}catch(e){return value}}function isObject(obj){return null!==obj&&"object"===(void 0===obj?"undefined":_typeof(obj))&&!Array.isArray(obj)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),MnOption=function(_HTMLElement){function MnOption(self){var _this,_ret;return _classCallCheck(this,MnOption),self=_this=_possibleConstructorReturn(this,(MnOption.__proto__||Object.getPrototypeOf(MnOption)).call(this,self)),_this.classList.add("mn-option"),_this.setInput(),_this.setCustomInput(),_this.setPlaceholder(),_this.input.checked&&_this.classList.add("checked"),_this.input.addEventListener("change",function(){if("radio"===_this.input.getAttribute("type")){var name=_this.input.getAttribute("name"),lastChecked=document.querySelector('.mn-option.checked[name="'+name+'"]');lastChecked&&lastChecked.classList.remove("checked")}_this.input.checked?_this.classList.add("checked"):_this.classList.remove("checked")}),_this.appendChild(_this.label),_ret=self,_possibleConstructorReturn(_this,_ret)}return _inherits(MnOption,_HTMLElement),_createClass(MnOption,[{key:"setInput",value:function(){function setInputAttribute(attribute){var isDefaultAttribute=attribute.hasOwnProperty("default"),attributeValue=element.getAttribute(attribute.name);if(isDefaultAttribute){var isValidValue=attribute.hasOwnProperty("values")&&attribute.values.indexOf(attributeValue)>=0,value=isValidValue?attributeValue:attribute.default;input.setAttribute(attribute.name,value)}else attributeValue&&input.setAttribute(attribute.name,attributeValue)}var element=this;if(this.hasAttribute("value")){var evaluatedValue=evaluate(this.getAttribute("value"));isObject(evaluatedValue)&&this.setAttribute("value",JSON.stringify(evaluatedValue))}else{var name=this.hasAttribute("name")?'[name="'+this.getAttribute("name")+'"]':"";console.error("missing value in mn-option"+name)}var inputAttributes=[{name:"type",values:["radio","checkbox"],default:"checkbox"},{name:"name"},{name:"autofocus"},{name:"checked"},{name:"disabled"},{name:"readonly"},{name:"value"},{name:"id"}],label=document.createElement("label");this.label=label;var input=document.createElement("input");this.input=input,inputAttributes.map(setInputAttribute),this.removeAttribute("id"),label.appendChild(input),this.addEventListener("mouseleave",function(){input.blur()})}},{key:"setCustomInput",value:function(){var type=this.getAttribute("type"),isNatural=this.classList.contains("natural");if(type&&!isNatural){var customInput=document.createElement("div");if(customInput.className="input",customInput.classList.add(type),this.label.appendChild(customInput),"checkbox"===type){var vector=document.createElementNS("http://www.w3.org/2000/svg","svg");vector.setAttribute("width","16px"),vector.setAttribute("height","16px"),vector.innerHTML='<g\n          stroke="none"\n          stroke-width="1"\n          fill="none"\n          fill-rule="evenodd"\n          stroke-linecap="round"\n          stroke-linejoin="round">\n            <g\n              transform="translate(2.000000, 3.000000)"\n              stroke-width="2"\n              stroke="#000000">\n                <polyline\n                  points="12.3825 0.581533333 3.653 10.3935333 0.273722222 6.7386"></polyline>\n            </g>\n        </g>',customInput.appendChild(vector)}}else{var background=document.createElement("div");background.classList.add("background"),this.label.appendChild(background)}}},{key:"setPlaceholder",value:function(){var placeholderText=document.createElement("span");placeholderText.classList.add("text"),placeholderText.textContent=this.getAttribute("placeholder")||this.getAttribute("value"),this.label.appendChild(placeholderText)}},{key:"value",get:function(){var form=this.closest("form")||document,name=this.getAttribute("name")?'[name="'+this.getAttribute("name")+'"]':":not([name])",options=form.querySelectorAll(".mn-option"+name),type=this.getAttribute("type"),value=Array.from(options).map(function(item){return item.querySelector("input")}).filter(function(item){return item.checked}).map(function(item){return evaluate(item.value)}),isRadio="radio"===type,isSingleOption=1===options.length,isBoolean="boolean"==typeof evaluate(options[0].getAttribute("value"));return isRadio||isSingleOption&&isBoolean?isSingleOption&&isBoolean?Boolean(value[0]):value[0]:value},set:function(value){function setById(value){value=evaluate(value);try{var _options=form.querySelectorAll(".mn-option"+name);_options=Array.from(_options).filter(function(option){var evaluatedValue=evaluate(option.getAttribute("value")),id=value.id||value._id;return id&&(id===evaluatedValue.id||id===evaluatedValue._id)}),_options.length?(_options[0].classList.add("checked"),_options[0].querySelector("input").checked=!0):console.error(JSON.stringify(value)+" is a invalid value to mn-option"+name)}catch(e){console.error(JSON.stringify(value)+" is a invalid value to mn-option"+name)}}var form=this.closest("form")||document,name=this.getAttribute("name")?'[name="'+this.getAttribute("name")+'"]':":not([name])",options=form.querySelectorAll(".mn-option"+name),type=options[0].getAttribute("type"),values=Array.isArray(value)?value:[value];if(Array.from(options).forEach(function(option){option.checked=!1}),value)if("radio"===type){var _value=values[0],stringifiedValue="string"==typeof _value?_value.replace(/"/g,'\\"'):_value?JSON.stringify(_value).replace(/"/g,'\\"'):_value,option=form.querySelector(".mn-option"+name+'[value="'+stringifiedValue+'"]');option?option.checked=!0:setById(_value)}else values.forEach(function(value){var stringifiedValue="string"==typeof value?value.replace(/"/g,'\\"'):value?JSON.stringify(value).replace(/"/g,'\\"'):value,option=form.querySelector(".mn-option"+name+'[value="'+stringifiedValue+'"]');option?option.checked=!0:setById(value)})}},{key:"checked",get:function(){return this.hasAttribute("checked")},set:function(checked){checked?(this.setAttribute("checked","true"),this.classList.add("checked")):(this.removeAttribute("checked"),this.classList.remove("checked")),this.querySelector("input").checked=checked}}]),MnOption}(HTMLElement);window.customElements.define("mn-option",MnOption),window.MnOption=MnOption;
//# sourceMappingURL=mn-option.js.map
